#
# ~/.gitconfig
#

# https://github.com/GitAlias/gitalias
[alias]
	git = !exec git
	# list aliases
	aliases = config --get-regexp alias
	a = add
	br = branch
	branches = branch --all
	c = commit
	cm = commit -m
	co = checkout
	d = diff
	ds = diff --staged
	p = push
	pu = pull
	r = restore
	rs = restore --staged
	st = status
	sw = switch
	rb = for-each-ref --sort=-committerdate --count=10 --format='%(refname:short)' refs/heads/
	lg = log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit
	tags = tag -l
	alias-master-as-main = !git symbolic-ref refs/heads/main refs/heads/master && git symbolic-ref refs/remotes/origin/main refs/remotes/origin/master && git switch main
	clone-with-submodules = '!git clone --recurse-submodules'
	squash = "!f(){ git reset --soft HEAD~${1} && git commit --edit -m\"$(git log --format=%B --reverse HEAD..HEAD@{1})\"; };f"
	# delete merged local branches
	bclean = "!f(){ git branch --merged ${1-main} | grep -v " ${1-main}$" | xargs -r git branch -d; }; f"
	# temporarily ignore a file
	ignore = update-index --assume-unchanged
	unignore = update-index --no-assume-unchanged
	ignored = !git ls-files -v | grep "^[[:lower:]]"

[core]
	pager = delta
  #excludesfile = ~/.gitignore_global
  #attributesfile = ~/.gitattributes

#[interactive]
#  diffFilter = delta --color-only

[apply]
  # Remove trailing whitespaces
  whitespace = fix

[delta]
  navigate = true    # use n and N to move between diff sections
	line-numbers = true
	# vscode
	# https://dandavison.github.io/delta/tips-and-tricks/using-delta-with-vscode.html
	hyperlinks = true
	hyperlinks-file-link-format = "vscode://file/{path}:{line}"
  # delta detects terminal colors automatically; set one of these to disable auto-detection
 	# dark = true
  # light = true

[merge]
	conflictstyle = zdiff3

[diff]
  algorithm = histogram
  colorMoved = plain
  mnemonicPrefix = true
  renames = true

[tag]
  sort = version:refname

[log]
  date = iso-local

[color]
	ui = auto

[color "branch"]
	current = yellow reverse
	local = yellow
	remote = green

[color "status"]
	added = yellow
	changed = green
	untracked = cyan

[init]
	defaultBranch = main
	templateDir = ~/.config/git/templates

[help]
	autocorrect = immediate

[credential]
	helper = cache --timeout=28800 # 8 hours

[commit]
	template = ~/.gitmessage

[column]
  ui = auto

[push]
	default = simple
	autoSetupRemote = true
  followTags = true

[fetch]
  prune = true
  pruneTags = true
  all = true

[branch]
  sort = -committerdate

[rebase]
  autoSquash = true
  autoStash = true
  updateRefs = true

[includeIf "gitdir:~/code/github/"]
	path = ~/.config/git/accounts/github

[includeIf "gitdir:~/code/azure/"]
	path = ~/.config/git/accounts/azure

[includeIf "gitdir:~/code/gitlab/"]
	path = ~/.config/git/accounts/gitlab
